<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/bgw/assets/css/just-the-docs-default.css"> <script src="/bgw/assets/js/vendor/lunr.min.js"></script> <script src="/bgw/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Network connectivity | BoardGameWork</title><meta name="generator" content="Jekyll v3.9.3" /><meta property="og:title" content="Network connectivity" /><meta property="og:locale" content="en_US" /><meta name="description" content="BoardGameWork" /><meta property="og:description" content="BoardGameWork" /><meta property="og:site_name" content="BoardGameWork" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Network connectivity" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"BoardGameWork","headline":"Network connectivity","url":"/bgw/network/connection/networkconnectivity.html"}</script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><div class="side-bar"><div class="site-header" role="banner"> <a href="/bgw/" class="site-title lh-tight"> BoardGameWork </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/bgw/" class="nav-list-link">Board Game Work</a><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Components category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/bgw/components/Components.html" class="nav-list-link">Components</a><ul class="nav-list"><li class="nav-list-item "><a href="/bgw/components/componentview/componentview.html" class="nav-list-link">ComponentView</a><li class="nav-list-item "><a href="/bgw/components/dynamiccomponent/dynamiccomponentview.html" class="nav-list-link">DynamicComponentView</a><li class="nav-list-item "><a href="/bgw/components/gamecomponents/gamecomponents.html" class="nav-list-link">GameComponents</a><li class="nav-list-item "><a href="/bgw/components/container/container.html" class="nav-list-link">Container</a><li class="nav-list-item "><a href="/bgw/components/layout/layout.html" class="nav-list-link">LayoutViews</a><li class="nav-list-item "><a href="/bgw/components/uicomponents/uicomponents.html" class="nav-list-link">UIComponents</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Util category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/bgw/util/util.html" class="nav-list-link">Util</a><ul class="nav-list"><li class="nav-list-item "><a href="/bgw/util/coordinate/coordinate.html" class="nav-list-link">Coordinate</a><li class="nav-list-item "><a href="/bgw/util/bidirectional-map/bidirectionalmap.html" class="nav-list-link">BiDirectionalMap</a><li class="nav-list-item "><a href="/bgw/util/stack/stack.html" class="nav-list-link">Stack</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Concepts category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/bgw/concepts/concepts.html" class="nav-list-link">Concepts</a><ul class="nav-list"><li class="nav-list-item "><a href="/bgw/concepts/visual/visual.html" class="nav-list-link">Visual</a><li class="nav-list-item "><a href="/bgw/concepts/animations/Animations.html" class="nav-list-link">Animations</a><li class="nav-list-item "><a href="/bgw/concepts/user-input/UserInput.html" class="nav-list-link">User Input</a><li class="nav-list-item "><a href="/bgw/concepts/drag-and-drop/DragAndDropExample.html" class="nav-list-link">Drag and Drop</a><li class="nav-list-item "><a href="/bgw/concepts/observable/observable.html" class="nav-list-link">Observable</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Dialogs category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/bgw/dialogs/dialogs.html" class="nav-list-link">Dialogs</a><ul class="nav-list"><li class="nav-list-item "><a href="/bgw/dialogs/dialog/dialog.html" class="nav-list-link">Dialog</a><li class="nav-list-item "><a href="/bgw/dialogs/filedialog/filedialog.html" class="nav-list-link">FileDialog</a></ul><li class="nav-list-item active"><button class="nav-list-expander btn-reset" aria-label="toggle items in Network category" aria-pressed="true"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/bgw/network/network.html" class="nav-list-link">Network</a><ul class="nav-list"><li class="nav-list-item active"><a href="/bgw/network/connection/networkconnectivity.html" class="nav-list-link active">Network connectivity</a><li class="nav-list-item "><a href="/bgw/network/json/json.html" class="nav-list-link">Json</a></ul></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search" role="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search BoardGameWork" aria-label="Search BoardGameWork" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/bgw/network/network.html">Network</a><li class="breadcrumb-nav-list-item"><span>Network connectivity</span></ol></nav><div id="main-content" class="main-content"><main><h1 id="network-communication"> <a href="#network-communication" class="anchor-heading" aria-labelledby="network-communication"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Network communication</h1><details open="" class="no_toc"> <summary class="text-delta"> Table of contents </summary><ol id="markdown-toc"><li><a href="#network-communication" id="markdown-toc-network-communication">Network communication</a><ol><li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a><ol><li><a href="#gradle-kotlin-dsl" id="markdown-toc-gradle-kotlin-dsl">Gradle Kotlin DSL</a><li><a href="#gradle-groovy-dsl" id="markdown-toc-gradle-groovy-dsl">Gradle Groovy DSL</a><li><a href="#maven" id="markdown-toc-maven">Maven</a></ol><li><a href="#getting-started" id="markdown-toc-getting-started">Getting started</a><li><a href="#establishing-a-connection" id="markdown-toc-establishing-a-connection">Establishing a connection</a><li><a href="#hosting-and-joining-game-sessions" id="markdown-toc-hosting-and-joining-game-sessions">Hosting and Joining game sessions.</a><li><a href="#sending-messages" id="markdown-toc-sending-messages">Sending messages</a><li><a href="#receiving-messages" id="markdown-toc-receiving-messages">Receiving messages</a></ol></ol></details><p>This section deals with the integration of network communication to establish multiplayer modes over the internet.</p><h2 id="prerequisites"> <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites</h2><p>In order to use network integration you first have to integrate bgw-net components into your buildscript, e.g. gradle etc. For client use both artifacts <em>bgw-net-common</em> and <em>bgw-net-client</em> are required. You can obtain the dependencies from maven central:</p><h3 id="gradle-kotlin-dsl"> <a href="#gradle-kotlin-dsl" class="anchor-heading" aria-labelledby="gradle-kotlin-dsl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gradle Kotlin DSL</h3><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">implementation</span><span class="p">(</span><span class="s">"tools.aqua:bgw-net-common:latest"</span><span class="p">)</span>
<span class="nf">implementation</span><span class="p">(</span><span class="s">"tools.aqua:bgw-net-client:latest"</span><span class="p">)</span>
</code></pre></div></div><h3 id="gradle-groovy-dsl"> <a href="#gradle-groovy-dsl" class="anchor-heading" aria-labelledby="gradle-groovy-dsl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gradle Groovy DSL</h3><div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">implementation</span> <span class="s1">'tools.aqua:bgw-net-common:latest'</span>
<span class="n">implementation</span> <span class="s1">'tools.aqua:bgw-net-client:latest'</span>
</code></pre></div></div><h3 id="maven"> <a href="#maven" class="anchor-heading" aria-labelledby="maven"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Maven</h3><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>tools.aqua<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>bgw-net-common<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>latest<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>tools.aqua<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>bgw-net-client<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>latest<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div><h2 id="getting-started"> <a href="#getting-started" class="anchor-heading" aria-labelledby="getting-started"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Getting started</h2><p>On the client side, the central communication interface is the <a href="/bgw/bgw-net-client-kdoc/bgw-net-client/tools.aqua.bgw.net.client/-board-game-client/index.html">BoardGameClient</a>. Create your own communication class inheriting from this class.</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MauMauBoardGameClient</span><span class="p">(</span>
	<span class="n">playerName</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
	<span class="n">host</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
	<span class="n">secret</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">BoardGameClient</span><span class="p">(</span>
	<span class="n">playerName</span> <span class="p">=</span> <span class="n">playerName</span><span class="p">,</span>
	<span class="n">host</span> <span class="p">=</span> <span class="n">host</span><span class="p">,</span>
	<span class="n">secret</span> <span class="p">=</span> <span class="n">secret</span><span class="p">,</span>
	<span class="n">networkLoggingBehavior</span> <span class="p">=</span> <span class="nc">NetworkLogging</span><span class="p">.</span><span class="nc">VERBOSE</span><span class="p">)</span>
</code></pre></div></div><p>Upon creation the server address, port and secret has to be passed and cannot be changed later on. Additionally, <a href="/bgw/bgw-net-client-kdoc/bgw-net-client/tools.aqua.bgw.net.client/-board-game-client/index.html">BoardGameClient</a> takes the player’s name for identification purposes. <a href="/bgw/bgw-net-client-kdoc/bgw-net-client/tools.aqua.bgw.net.client/-board-game-client/index.html">BoardGameClient</a> implements dedicated network logging to the standard console which can be turned on and controlled via the <code class="language-plaintext highlighter-rouge">netwokLoggingBehaviour</code> parameter. The following options are available (see <a href="/bgw/bgw-net-client-kdoc/bgw-net-client/tools.aqua.bgw.net.client/-network-logging/index.html">NetworkLogging</a>):</p><ul><li>VERBOSE: Verbose logging printing each step to the console including serialized Json.<li>INFO: Log incoming and outgoing messages in human-readable format to keep track of network traffic.<li>ERRORS: Only log errors during communication.<li>NO_LOGGING: Completely deactivate logging.</ul><p><em>The default value is NO_LOGGING.</em></p><h2 id="establishing-a-connection"> <a href="#establishing-a-connection" class="anchor-heading" aria-labelledby="establishing-a-connection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Establishing a connection</h2><p>Once set up you may call <code class="language-plaintext highlighter-rouge">connect</code> on the <a href="/bgw/bgw-net-client-kdoc/bgw-net-client/tools.aqua.bgw.net.client/-board-game-client/index.html">BoardGameClient</a> in order to start a connection. This method will block the current thread until a connection was established or the request timed out. You may want to think about multithreading in this situation. The function will return <code class="language-plaintext highlighter-rouge">true</code> iff the connection was established successfully.</p><p>A connection may be closed safely by calling <code class="language-plaintext highlighter-rouge">disconnnect</code>.</p><p>The connection state may be checked via <code class="language-plaintext highlighter-rouge">isOpen</code> property.</p><h2 id="hosting-and-joining-game-sessions"> <a href="#hosting-and-joining-game-sessions" class="anchor-heading" aria-labelledby="hosting-and-joining-game-sessions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hosting and Joining game sessions.</h2><p>A game session may be started by calling <code class="language-plaintext highlighter-rouge">createGame</code>. Each session gets identified by a unique <code class="language-plaintext highlighter-rouge">sessionID</code> that has to be passed to the function. Calling <code class="language-plaintext highlighter-rouge">createGame</code> automatically adds this client to the newly created game on the server side. Additionally, the gameID must match the registered gameID on the server in order to identify the correct set of message schemas for this game. <code class="language-plaintext highlighter-rouge">greetingMessage</code> will be sent to all players upon joining this session.</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">client</span> <span class="p">=</span> <span class="nc">MauMauBoardGameClient</span><span class="p">(</span><span class="n">playerName</span> <span class="p">=</span> <span class="s">"Alice"</span><span class="p">,</span> <span class="n">host</span> <span class="p">=</span> <span class="s">"localhost"</span><span class="p">,</span>  <span class="n">secret</span> <span class="p">=</span> <span class="s">"SECRET"</span><span class="p">)</span>

<span class="k">if</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="nf">connect</span><span class="p">())</span>
  <span class="n">client</span><span class="p">.</span><span class="nf">createGame</span><span class="p">(</span><span class="n">gameID</span> <span class="p">=</span> <span class="s">"MauMau"</span><span class="p">,</span> <span class="n">sessionID</span> <span class="p">=</span> <span class="s">"Alice vs. Bob"</span><span class="p">,</span> <span class="n">greetingMessage</span> <span class="p">=</span> <span class="s">"Welcome to MauMau!"</span><span class="p">)</span>
</code></pre></div></div><p>To join an existing session, you may call <code class="language-plaintext highlighter-rouge">joinGame</code> passing the sessionID to join to. The <code class="language-plaintext highlighter-rouge">greetingMessage</code> will be broadcast to all players in this session.</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">client</span> <span class="p">=</span> <span class="nc">MauMauBoardGameClient</span><span class="p">(</span><span class="n">playerName</span> <span class="p">=</span> <span class="s">"Bob"</span><span class="p">,</span> <span class="n">host</span> <span class="p">=</span> <span class="s">"localhost"</span><span class="p">,</span>  <span class="n">secret</span> <span class="p">=</span> <span class="s">"SECRET"</span><span class="p">)</span>

<span class="k">if</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="nf">connect</span><span class="p">())</span>
  <span class="n">client</span><span class="p">.</span><span class="nf">joinGame</span><span class="p">(</span><span class="n">sessionID</span> <span class="p">=</span> <span class="s">"Alice vs. Bob"</span><span class="p">,</span> <span class="n">greetingMessage</span> <span class="p">=</span> <span class="s">"Hi, I am Bob!"</span><span class="p">)</span>
</code></pre></div></div><p>After creating or joining to a game, the server will respond with dedicated Responses which will invoke <code class="language-plaintext highlighter-rouge">onCreateGameResponse</code> and <code class="language-plaintext highlighter-rouge">onJoinGameResponse</code>. Override these methods to react to the different status codes:</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreateGameResponse</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="nc">CreateGameResponse</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">when</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
    <span class="nc">CreateGameResponseStatus</span><span class="p">.</span><span class="nc">SUCCESS</span> <span class="p">-&gt;</span>
        <span class="nf">prinln</span><span class="p">(</span><span class="s">"Successfully created game."</span><span class="p">)</span>

    <span class="nc">CreateGameResponseStatus</span><span class="p">.</span><span class="nc">ALREADY_ASSOCIATED_WITH_GAME</span> <span class="p">-&gt;</span>
        <span class="nf">error</span><span class="p">(</span><span class="s">"Leave current game first."</span><span class="p">)</span>

    <span class="nc">CreateGameResponseStatus</span><span class="p">.</span><span class="nc">SESSION_WITH_ID_ALREADY_EXISTS</span> <span class="p">-&gt;</span>
        <span class="nf">error</span><span class="p">(</span><span class="s">"Session id already exists."</span><span class="p">)</span>

    <span class="nc">CreateGameResponseStatus</span><span class="p">.</span><span class="nc">GAME_ID_DOES_NOT_EXIST</span> <span class="p">-&gt;</span>
        <span class="nf">error</span><span class="p">(</span><span class="s">"GameID does not exist."</span><span class="p">)</span>

    <span class="nc">CreateGameResponseStatus</span><span class="p">.</span><span class="nc">SERVER_ERROR</span> <span class="p">-&gt;</span>
        <span class="nf">error</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">override</span> <span class="k">fun</span> <span class="nf">onJoinGameResponse</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="nc">JoinGameResponse</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">when</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
    <span class="nc">JoinGameResponseStatus</span><span class="p">.</span><span class="nc">SUCCESS</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="nf">prinln</span><span class="p">(</span><span class="s">"Successfully joined game."</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"The host's greeting is \"${response.message}\"."</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="nc">JoinGameResponseStatus</span><span class="p">.</span><span class="nc">ALREADY_ASSOCIATED_WITH_GAME</span> <span class="p">-&gt;</span>
        <span class="nf">error</span><span class="p">(</span><span class="s">"You are already in a game."</span><span class="p">)</span>

    <span class="nc">JoinGameResponseStatus</span><span class="p">.</span><span class="nc">INVALID_SESSION_ID</span> <span class="p">-&gt;</span>
        <span class="nf">error</span><span class="p">(</span><span class="s">"SessionID invalid."</span><span class="p">)</span>

    <span class="nc">JoinGameResponseStatus</span><span class="p">.</span><span class="nc">PLAYER_NAME_ALREADY_TAKEN</span> <span class="p">-&gt;</span>
        <span class="nf">error</span><span class="p">(</span><span class="s">"Player name already exists."</span><span class="p">)</span>

    <span class="nc">JoinGameResponseStatus</span><span class="p">.</span><span class="nc">SERVER_ERROR</span> <span class="p">-&gt;</span>
        <span class="nf">error</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>All connected players will get notified when a player joins or leaves the session via <code class="language-plaintext highlighter-rouge">onPlayerJoined</code> and <code class="language-plaintext highlighter-rouge">onPlayerLeft</code>.</p><p><strong>Please note</strong> that all response functions and event handlers get called asynchronously. It is therefore necessary to call <code class="language-plaintext highlighter-rouge">BoardGameApplication.runOnGUIThread{ ... }</code> to resync to the GUI thread when performing view changes.</p><h2 id="sending-messages"> <a href="#sending-messages" class="anchor-heading" aria-labelledby="sending-messages"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sending messages</h2><p>Once registered in a game session you may now send messages to your opponents. The server does not implement any form of keeping track whose turn it is at the moment.</p><p>The function <code class="language-plaintext highlighter-rouge">sendGameActionMessage</code> takes a <code class="language-plaintext highlighter-rouge">GameAction</code> instance and sends it to all connected opponents. For each type of game action that you want to communicate you have to declare a separate (data) class inheriting from <code class="language-plaintext highlighter-rouge">GameAction</code>. For our MauMau example let’s assume that there are four types of game actions:</p><ul><li><em>MauMauInitGameAction</em> - First initialization containing the card stacks and hand cards.<li><em>MauMauEndGameAction</em> - You played your last card and won the game.<li><em>MauMauShuffleStackGameAction</em> - The draw stack was empty and had to be shuffled.<li><em>MauMauGameAction</em> - You have played or taken a card from the stack.</ul><p>As mentioned all game action classes have to inherit from <code class="language-plaintext highlighter-rouge">GameAction</code>. In addition to that they have to be annotated with <code class="language-plaintext highlighter-rouge">@GameActionClass</code>. For our four sample classes this looks like this:</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GameActionClass</span>
<span class="kd">data class</span> <span class="nc">MauMauInitGameAction</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">hostCards</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">MauMauGameCard</span><span class="p">&gt;,</span>
    <span class="kd">val</span> <span class="py">yourCards</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">MauMauGameCard</span><span class="p">&gt;,</span>
    <span class="kd">val</span> <span class="py">drawStack</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">MauMauGameCard</span><span class="p">&gt;,</span>
    <span class="kd">val</span> <span class="py">gameStack</span><span class="p">:</span> <span class="nc">MauMauGameCard</span><span class="p">,</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">GameAction</span><span class="p">()</span>
</code></pre></div></div><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GameActionClass</span>
<span class="kd">data class</span> <span class="nc">MauMauEndGameAction</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">winner</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">GameAction</span><span class="p">()</span>
</code></pre></div></div><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GameActionClass</span>
<span class="kd">data class</span> <span class="nc">MauMauShuffleStackGameAction</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">drawStack</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">MauMauGameCard</span><span class="p">&gt;,</span>
    <span class="kd">val</span> <span class="py">gameStack</span><span class="p">:</span> <span class="nc">MauMauGameCard</span><span class="p">,</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">GameAction</span><span class="p">()</span>
</code></pre></div></div><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GameActionClass</span>
<span class="kd">data class</span> <span class="nc">MauMauGameAction</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">action</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="c1">//Restricted by Enum values</span>
    <span class="kd">val</span> <span class="py">card</span><span class="p">:</span> <span class="nc">MauMauGameCard</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">GameAction</span><span class="p">()</span>
</code></pre></div></div><p>After sending a game action, the server will respond in <code class="language-plaintext highlighter-rouge">onGameActionResponse</code>.</p><h2 id="receiving-messages"> <a href="#receiving-messages" class="anchor-heading" aria-labelledby="receiving-messages"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Receiving messages</h2><p>Received messages get propagated through <code class="language-plaintext highlighter-rouge">onGameActionReceived</code> by default. Consider this method as a fallback solution as it gets a parameter of type <code class="language-plaintext highlighter-rouge">GameAction</code>. It would therefore be necessary to cast the object down by instanceof-switching.</p><p>Instead, bgw-net allows you to declare dedicated functions for each object type that may get received. These functions have to be declared inside your <code class="language-plaintext highlighter-rouge">BoardGameClient</code> implementation or further down the inheritance hierarchy. The function must declare two formal parameters</p><ul><li>A <code class="language-plaintext highlighter-rouge">GameAction</code> instance<li>A <code class="language-plaintext highlighter-rouge">String</code> for the sending player’s identification</ul><p>Additionally, each receiver function must be annotated with <code class="language-plaintext highlighter-rouge">@GameActionReceiver</code>. For our example these functions may look as follows:</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GameActionReceiver</span>
<span class="k">private</span> <span class="k">fun</span> <span class="nf">onInitGameReceived</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">MauMauInitGameAction</span><span class="p">,</span> <span class="n">sender</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//Init game received</span>
<span class="p">}</span>

<span class="nd">@GameActionReceiver</span>
<span class="k">private</span> <span class="k">fun</span> <span class="nf">onEndGameReceived</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">MauMauEndGameAction</span><span class="p">,</span> <span class="n">sender</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//End game received</span>
<span class="p">}</span>

<span class="nd">@GameActionReceiver</span>
<span class="k">private</span> <span class="k">fun</span> <span class="nf">onShuffleStackReceived</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">MauMauShuffleStackGameAction</span><span class="p">,</span> <span class="n">sender</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//Stack shuffled received</span>
<span class="p">}</span>

<span class="nd">@GameActionReceiver</span>
<span class="k">private</span> <span class="k">fun</span> <span class="nf">onGameActionReceived</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">MauMauGameAction</span><span class="p">,</span> <span class="n">sender</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//Game Action received</span>
<span class="p">}</span>
</code></pre></div></div><p>The name of the function and parameters are free to choose as well as the visibility modifier. Although when two functions with the same parameter types get detected, only the first will be used, and you will get a warning printed to console. <strong>Note</strong> that the order of scanning and therefor the distinction which of these redundant declarations will be used is not stable and may vary between execution cycles due to compiler optimizations. It is therefore highly recommended, to declare exactly one receiver function for each <code class="language-plaintext highlighter-rouge">GameAction</code> instance.</p><p><strong>Please note</strong> that all connected players have to declare the exact same classes in order to ensure correct serialization and deserialization. Implement <code class="language-plaintext highlighter-rouge">toString()</code> method in all GameActionClasses in order to ensure good debugging of the network traffic.</p></main></div></div><div class="search-overlay"></div></div>
